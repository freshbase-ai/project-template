version: "2.0"

# =============================================================================
# System Configuration (v2.0 - Type-Based)
# =============================================================================
system:
  mode: "strict_types"        # Disallows commit of .md without 'type'
  allow_root_files: true      # Allows files at root (uncategorized)
  hidden_from_user: true      # .freshbase hidden from user, visible to agents
  on_missing_type: "auto_fix" # auto_fix | block

  heuristic:
    auto_apply_threshold: 0.7    # Confidence m√≠nima para auto-aplicar
    suggestion_only_threshold: 0.3
    weights:
      path_match: 0.4
      content_match: 0.3
      filename_pattern: 0.2
      proximity_to_similar: 0.1

# =============================================================================
# Vaults (Read-Only Parallel Repositories)
# =============================================================================
# Vaults are read-only parallel repositories for referencing base product specs.
# Uncomment and configure if your project inherits specifications from a core product.
vaults: []
  # - name: "core"
  #   source: "git@github.com:org/product-core-specs.git"
  #   mount_point: ".freshbase/vaults/core"
  #   access: "readonly"

# =============================================================================
# Type Definitions
# =============================================================================
# Principle: What defines a file is its metadata, not where it is saved.
types:
  spec:
    detection:
      frontmatter:
        field: "type"
        equals: "spec"
      filename_suffix: ".spec.md"
    required_fields:
      - field: "title"
        validation: "non_empty"
      - field: "context"
        validation: "non_empty"
      - field: "status"
        validation: "enum"
        enum: ["draft", "in_review", "approved", "implemented"]
      - field: "version"
        validation: "placeholder_ok"
    default_path: "specs/"
    colocation_strategy:
      - rule: "near_context"
      - rule: "near_parent"

  adr:
    detection:
      frontmatter:
        field: "type"
        equals: "adr"
      filename_match: "ADR-*"
    required_fields:
      - field: "title"
        validation: "non_empty"
      - field: "status"
        validation: "enum"
        enum: ["proposed", "accepted", "deprecated", "superseded"]
      - field: "deciders"
        validation: "non_empty"
    default_path: "decisions/"

  meeting:
    detection:
      frontmatter:
        field: "type"
        equals: "meeting"
    required_fields:
      - field: "title"
        validation: "non_empty"
      - field: "date"
        validation: "non_empty"
    default_path: "meetings/"

  context:
    detection:
      frontmatter:
        field: "type"
        equals: "context"
    required_fields:
      - field: "title"
        validation: "non_empty"
      - field: "responsibility"
        validation: "non_empty"
    default_path: "contexts/"

  problem:
    detection:
      frontmatter:
        field: "type"
        equals: "problem"
    required_fields:
      - field: "title"
        validation: "non_empty"
      - field: "status"
        validation: "enum"
        enum: ["draft", "validated", "invalidated"]
    default_path: "discovery/problems/"

  hypothesis:
    detection:
      frontmatter:
        field: "type"
        equals: "hypothesis"
    required_fields:
      - field: "title"
        validation: "non_empty"
      - field: "status"
        validation: "enum"
        enum: ["draft", "testing", "validated", "invalidated"]
      - field: "problem"
        validation: "non_empty"
    default_path: "discovery/hypotheses/"

  flow:
    detection:
      frontmatter:
        field: "type"
        equals: "flow"
    required_fields:
      - field: "title"
        validation: "non_empty"
      - field: "status"
        validation: "enum"
        enum: ["draft", "active", "deprecated"]
    default_path: "flows/"

  plan:
    detection:
      frontmatter:
        field: "type"
        equals: "plan"
    required_fields:
      - field: "title"
        validation: "non_empty"
      - field: "spec"
        validation: "non_empty"
      - field: "status"
        validation: "enum"
        enum: ["planning", "in_progress", "blocked", "completed"]
    default_path: "contexts/"

  scenarios:
    detection:
      frontmatter:
        field: "type"
        equals: "scenarios"
    required_fields:
      - field: "title"
        validation: "non_empty"
      - field: "feature"
        validation: "non_empty"
    default_path: "features/"

# =============================================================================
# Paths
# =============================================================================
paths:
  root: ".freshbase"
  templates: ".freshbase/templates"
  hooks: ".freshbase/hooks"
  vaults: ".freshbase/vaults"

# =============================================================================
# Legacy Compatibility (v1.0 fields, ignored in v2.0)
# =============================================================================
# These fields are kept for backward compatibility but are not used in v2.0.
# The type-based system replaces folder-based organization.

# project:
#   name: "{{PROJECT_NAME}}"
#   description: "Discovery and planning workspace"
#   language: "pt-BR"

# agent:
#   model: "auto"
#   provider: "cursor"
#   autoCommit: false

# hooks:
#   onInit: "hooks/on-init.md"
#   preCommit: "hooks/pre-commit.md"
#   styleGuide: "hooks/style-guide.md"
